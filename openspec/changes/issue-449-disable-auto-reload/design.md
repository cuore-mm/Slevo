## Context

現在の実装は、画像コンポーネントが画面外で破棄されて再表示された際に、画像リクエストが再生成されるたび `onLoading` が先に走る構成です。そのため失敗状態を保持していても、再表示直後に一時的なローディング表示へ遷移し、通信失敗後に再び失敗アイコンへ戻る見え方になります。

本変更では、issue #449 で導入した失敗時リロード導線を維持しつつ、失敗状態の項目は明示的なリロード操作があるまで再取得を行わない設計に切り替えます。

## Goals / Non-Goals

**Goals:**
- 失敗表示中の項目は再表示されても失敗表示を維持し、ローディング再表示を発生させない。
- 再取得トリガーをリロード操作のみに限定し、表示ライフサイクル再生成と分離する。
- 投稿サムネイル、ビューア本体、ビューア下部サムネイルで同一契約を適用する。

**Non-Goals:**
- 失敗時に自動バックオフ再試行を導入すること。
- ネットワーク再接続イベントで自動復旧させること。
- TopBar を含む既存操作レイアウトの変更。

## Decisions

1. 失敗状態中は画像リクエストを発行しない分岐を設ける。
   - 代替案: リクエストは常に発行し、`onLoading` で失敗状態を維持する。
   - 採用理由: リクエスト自体が走るとローディング表示や通信が発生し、失敗表示固定の目的と矛盾するため。

2. 再試行トリガーは既存の retry nonce を唯一の再取得条件として扱う。
   - 代替案: 画面再表示やページ復帰時にも nonce を自動更新する。
   - 採用理由: 自動更新は「明示再試行のみ」の契約を壊すため。

3. 失敗状態の寿命は対象 URL/index の UI 状態に紐づけて維持する。
   - 代替案: 失敗状態を毎回初期化し、表示時に再判定する。
   - 採用理由: 初期化するとスクロール復帰時の表示が不安定になり、今回の不具合が再発するため。

## Risks / Trade-offs

- [Risk] 一時的ネットワーク障害が復旧しても自動回復しない
  → Mitigation: 失敗表示のリロード導線を常時明示し、操作コストを低く保つ。

- [Risk] 失敗状態保持が過剰に残留し、表示と実際の可用性がずれる
  → Mitigation: リロード操作時に必ず失敗状態をクリアして再評価し、成功時に状態を更新する。

- [Risk] 3 画面で実装差異が生じる
  → Mitigation: 「失敗中は非リクエスト」「明示再試行のみリクエスト」の2条件を共通チェックリストとして適用する。

## Migration Plan

1. 投稿サムネイルで失敗状態時は画像リクエストを発行しない描画分岐へ変更する。
2. ビューア本体で失敗状態時は失敗オーバーレイのみ描画し、リクエスト発行を抑止する。
3. 下部サムネイルバーで失敗状態時は失敗アイコン表示のみ行い、再表示での再取得を抑止する。
4. リロード操作時にのみ再取得が起きることを 3 箇所で確認する。

## Open Questions

- なし。
