## Context

板画面とスレ画面では、共通の方向ジェスチャー検出ロジックを使ってアクション実行とヒント表示を制御している。現状は方向未確定の終了やキャンセルでも無効ジェスチャー扱いになり得るため、縦スクロールの通常操作中に「無効なジェスチャーです」が表示されることがある。対象はUI層の入力判定であり、データ層や永続化の変更は不要である。

## Goals / Non-Goals

**Goals:**
- 通常の縦スクロール操作では無効ジェスチャー表示を出さない。
- 無効ジェスチャー表示を「方向ジェスチャーとして成立を試みたが矛盾した軌跡」に限定する。
- 板画面とスレ画面で同じ判定基準を適用し、表示挙動を一貫させる。

**Non-Goals:**
- ジェスチャー割り当て機能や設定UIの仕様変更。
- 新しいジェスチャー方向の追加やしきい値仕様の大幅変更。
- ジェスチャーヒントの文言やデザイン変更。

## Decisions

- 判定状態を「未成立（None）」「有効方向（Direction）」「無効（Invalid）」で明確に分離し、未成立をエラー扱いしない。
  - 代替案: すべての終了経路で無効通知を維持する。
  - 採用理由: 通常スクロールでの誤通知を抑止できず、issue 446 の再発要因を残すため。
- 無効通知の発火条件を、方向確定後の矛盾入力や複合方向超過などの実際の無効軌跡に限定する。
  - 代替案: 一定移動量未満の終了も無効通知する。
  - 採用理由: 短いタッチやスクロール開始失敗を無効表示対象に含める合理性が低いため。
- 画面側（Board/Thread）は既存の `onGestureInvalid` ハンドラ構造を維持し、共通検出ロジック側で通知品質を改善する。
  - 代替案: 各画面で追加ガードを実装する。
  - 採用理由: 重複実装を避け、将来の画面追加時も同品質を保てるため。

## Risks / Trade-offs

- [Risk] 無効通知を絞り込みすぎると、本来知らせるべき誤操作が表示されない可能性がある。 → Mitigation: 既存の有効方向検出シナリオと併せて、無効通知が必要な軌跡をシナリオで明示する。
- [Risk] ポインタイベント消費タイミングの変更でスクロール・ページング競合が変化する可能性がある。 → Mitigation: 板/スレ双方で縦スクロール連続操作と方向ジェスチャー操作の回帰確認を行う。
- [Trade-off] ヒント表示の厳密化により、従来より無効表示の回数が減る。 → 仕様上は意図した変化であり、誤検知抑止を優先する。
