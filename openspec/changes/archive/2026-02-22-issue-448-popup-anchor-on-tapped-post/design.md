## Context

現状は、2段目以降のポップアップ追加時に「直前ポップアップの表示位置」を次の基準座標として再利用している。
このため、ポップアップ内で下方の投稿をタップしても新しいポップアップがタップ位置と離れた場所に出ることがあり、操作起点が追いづらい。

## Goals / Non-Goals

**Goals:**
- 2段目以降でも、タップした投稿の画面座標を基準に新規ポップアップを表示する。
- 1段目と同様に、タップした投稿と新規ポップアップがわずかに重なる見え方を維持する。
- 既存のポップアップ追加契約（重複抑止・閉じる挙動・スクロール・アニメーション）を変更しない。

**Non-Goals:**
- ポップアップ幅、高さ縮小ルール、装飾デザインの変更。
- タップ対象（返信番号/ID/本文/返信元）の機能仕様変更。
- スレッド本体リスト側の1段目表示仕様の再設計。

## Decisions

- **投稿単位の座標計測をポップアップ内でも行う**
  - 各投稿描画要素で `positionInRoot` 由来の座標を保持し、タップ時にその投稿座標を `baseOffset` として送る。
  - 代替案としてポップアップ全体座標を使う方式もあるが、投稿ごとの差が反映できないため不採用。

- **重なり量は1段目と同じ表示計算契約に揃える**
  - 新規追加時の基準座標の意味を1段目・多段で統一し、表示位置計算関数側で同一の重なりルールを適用する。
  - これにより「少し被る」見え方を段数に依存せず再現できる。

- **イベント経路ごとに同じ座標契約を適用する**
  - 本文タップ、返信番号、返信元、IDタップの各経路で同一の投稿座標を渡す。
  - 特定経路のみ座標基準が異なる状態を防ぎ、位置挙動を一貫化する。

## Risks / Trade-offs

- [Risk] 投稿内のタップ可能部位ごとに座標取得元が異なると、表示位置が微妙にずれる可能性がある。
  - Mitigation: 投稿コンテナ単位で基準座標を統一し、全タップ経路で同一オフセットを参照する。

- [Risk] 座標計測更新タイミングが遅れると、初回タップ時に古い座標が使われる可能性がある。
  - Mitigation: `onGloballyPositioned` で最新値を更新し、未計測時のフォールバック座標を明示する。

- [Trade-off] 投稿ごとの座標保持が追加され、UIコードの状態管理がわずかに増える。
  - Mitigation: 既存の座標ホルダーパターンを再利用し、局所的な責務に閉じ込める。
