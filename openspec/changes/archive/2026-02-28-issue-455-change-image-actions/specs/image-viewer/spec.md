## MODIFIED Requirements

### Requirement: 画像ビューアトップバーのその他メニュー
システムは画像ビューアのトップバーにその他アクションボタンを表示し、押下時に画像読み込み状態に応じた `DropdownMenu` のアクションを選択できるようにするSHALL。

#### Scenario: 読み込み成功時は既存メニューを表示する
- **WHEN** 対象画像が読み込み成功状態で、ユーザーが画像ビューアのその他ボタンをタップする
- **THEN** システムは単体保存を除く既存画像アクションを表示する

#### Scenario: 404/410失敗時は限定メニューを表示する
- **WHEN** 対象画像の読み込み失敗種別が 404 または 410 で、ユーザーがその他ボタンをタップする
- **THEN** システムは `NG追加` と `URLコピー` のみを表示する

#### Scenario: その他失敗時はレンズを含む失敗向けメニューを表示する
- **WHEN** 対象画像の読み込み失敗種別が 404/410 以外で、ユーザーがその他ボタンをタップする
- **THEN** システムは `NG追加`、`URLコピー`、`Googleレンズ` を表示する

#### Scenario: 読み込み中は読み込み向けメニューを表示する
- **WHEN** 対象画像が読み込み中状態で、ユーザーがその他ボタンをタップする
- **THEN** システムは `NG追加`、`URLコピー`、`Googleレンズ` を表示する

#### Scenario: バー非表示時はメニューを閉じる
- **WHEN** ユーザー操作により画像ビューアのバー表示がオフになる
- **THEN** システムは表示中の `DropdownMenu` を閉じる

#### Scenario: メニュー表示中に状態が変化したら内容を差し替える
- **WHEN** `DropdownMenu` 表示中に対象画像状態が変化する
- **THEN** システムはメニューを閉じずに表示アクションを再評価し、アニメーション付きで内容を差し替える

### Requirement: その他メニューのアクション実行
システムは画像ビューアのその他メニューで選択されたアクションを、対象画像の読み込み状態で許可された範囲内で実行し、共通実行契約に従って処理しなければならないMUST。

#### Scenario: 成功時に既存アクションを実行する
- **WHEN** 対象画像が読み込み成功状態で、ユーザーがその他メニューから既存アクションを選択する
- **THEN** システムは現在表示中画像を対象に既存画像アクションと同等の処理を実行する

#### Scenario: 404/410失敗時に限定アクションのみ実行する
- **WHEN** 対象画像の読み込み失敗種別が 404 または 410 の状態で、ユーザーがその他メニューを操作する
- **THEN** システムは `NG追加` と `URLコピー` のみ実行可能にし、他アクションは実行しない

#### Scenario: その他失敗時に失敗向けアクションを実行する
- **WHEN** 対象画像の読み込み失敗種別が 404/410 以外で、ユーザーがその他メニューを操作する
- **THEN** システムは `NG追加`、`URLコピー`、`Googleレンズ` を実行可能にする

#### Scenario: 読み込み中に読み込み向けアクションを実行する
- **WHEN** 対象画像が読み込み中状態で、ユーザーがその他メニューを操作する
- **THEN** システムは `NG追加`、`URLコピー`、`Googleレンズ` を実行可能にする
