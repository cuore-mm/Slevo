## Context

`MomentumBar` は表示中インジケータ計算の連続化により、通常スクロール時の見た目は改善した。
しかしミニマップバーの直接ドラッグ経路では、ポインタ位置を投稿インデックスへ丸めて `scrollToItem` を呼ぶ離散制御のため、バー操作時のみかくつきが残っている。
本変更は、バー操作入力を連続スクロール制御へ置き換え、表示連続性と入力連続性を一致させることを目的とする。

## Goals / Non-Goals

**Goals:**
- バー直接ドラッグ時のスクロールを連続化し、体感かくつきを抑制する。
- 高頻度ドラッグ入力時でも更新負荷を安定化する。
- 既存のミニマップ描画・マーカー機能とタップ操作互換を維持する。

**Non-Goals:**
- ミニマップの見た目（配色、幅、レイアウト）の変更。
- 勢いグラフ算出式やマーカー表示条件の変更。
- スレッド本体の通常スクロール挙動の再設計。

## Decisions

1. ドラッグ操作は差分ベースの連続スクロールへ移行する。
   - 採用: バー上のドラッグ差分（dy）を、リスト側スクロール量へ換算して `scrollBy` で反映する。
   - 代替案: 現行の `scrollToItem(index)` を高頻度で呼び続ける。
   - 判断理由: インデックス丸めを残す限り段階ジャンプが残るため、入力値から連続量を扱う方式が必要。

2. ドラッグ更新はポインタイベント処理内で直列に処理する。
   - 採用: ドラッグハンドラ内で順次スクロール更新し、イベントごとの新規 `launch` を避ける。
   - 代替案: 既存どおり `launch { ... }` を各イベントで起動する。
   - 判断理由: コルーチン積み上がりによる追従遅延と体感かくつきを防ぐため。

3. タップ操作は既存ジャンプ仕様を維持する。
   - 採用: タップ時は現行のインデックスジャンプ系挙動を維持し、ドラッグ連続化のみ適用する。
   - 代替案: タップも連続換算に統一する。
   - 判断理由: 操作期待値としてタップは即時ジャンプが自然であり、今回の不具合対象はドラッグ時の連続性不足に限定されるため。

## Risks / Trade-offs

- [Risk] リスト全高とバー高の換算誤差により、端付近で追従量が過不足になる可能性 → Mitigation: `layoutInfo` ベースで換算係数を算出し、上下端でクランプする。
- [Risk] 長スレッドでの連続 `scrollBy` が過剰に発火する可能性 → Mitigation: 1イベントあたりの更新を最小限に保ち、不要な再計算を避ける。
- [Risk] 既存タップ挙動との干渉 → Mitigation: タップ経路とドラッグ経路を明確に分離し、回帰確認をタスクに含める。

## Migration Plan

1. `MomentumBar` のドラッグ経路を差分ベース連続スクロールへ置換する。
2. 端到達時のクランプと境界条件（0件/1件/可視情報不足）を維持する。
3. ミニマップバーの直接ドラッグで連続追従することを手動確認する。
4. タップジャンプと既存マーカー描画の回帰確認を行う。
5. 問題発生時はドラッグ経路のみロールバックし、表示ロジックは維持する。

## Open Questions

- なし
