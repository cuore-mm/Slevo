## Context
- 現在のレス一覧はリロード時に全件再整形され、既存レスの並びが変化することがある。
- ユーザーは「既存レスの順序は固定し、新着レスのみを末尾に追加」する挙動を求めている。

## Goals / Non-Goals
- Goals:
  - 既存レスの表示順を維持したまま、新着レスを末尾に追加する
  - NUMBER/TREE の両方で同じグループ追加の考え方を適用する
  - 新着バーは最新グループの先頭のみ表示する（新着0件では表示しない）
  - グループ状態はスレッドタブを閉じるまで ViewModel 内で保持する
- Non-Goals:
  - 端末再起動やアプリ再起動を跨ぐ永続化
  - Dat パースや ReplyInfo 生成の仕様変更
  - 検索/NG のルール変更

## Decisions
- Decision: 表示用のレス一覧は「グループ配列」で保持し、更新時に新グループを末尾へ追加する。
  - 理由: 既存レスの順序を固定するには、過去グループを再計算せず保持するのが最小変更。
- Decision: グループ内の並びは現行の整形ロジックを使い、NUMBER/TREE の差分を吸収する。
  - 理由: 「グループ内の整形はこれまで通り」を満たすため。
- Decision: 新着バーは最新グループの先頭位置（表示リスト上の index）でのみ表示する。
  - 理由: 要求で「最新のみ」「新着0件は非表示」と明示されているため。

## Alternatives considered
- 毎回全件を再整形し、既存レスの順序を固定する差分ソートを入れる。
  - 既存挙動と干渉しやすく、変更範囲が増えるため不採用。
- ストレージへグループを永続化する。
  - 要求にないため不採用。

## Risks / Trade-offs
- ツリー順のグループ化で、親レスが過去グループにある場合の見え方が変わる可能性。
  - 対策: グループ内の整形は現行ロジックを継続し、必要に応じて dimmed 親を同一グループ内に挿入する。
- 表示状態の保持で ViewModel のメモリ使用量が増える。
  - 対策: スレッドタブ終了時に状態を破棄する。

## Migration Plan
- 新しいグループ状態を導入し、初回ロード時は「1グループのみ」で開始する。
- 既存の `firstAfterIndex` 算出を最新グループ先頭に置き換える。

## Open Questions
- なし（要件確認済み）
