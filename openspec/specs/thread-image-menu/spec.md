# thread-image-menu Specification

## Purpose
TBD - created by archiving change add-batch-image-save. Update Purpose after archive.
## Requirements
### Requirement: レス内画像の一括保存
システムは画像メニューに「レス内の画像をすべて保存」を提供し、選択時に対象レス本文の画像URLをまとめて保存するSHALL。

#### Scenario: レス内画像をまとめて保存する
- **WHEN** ユーザーが画像サムネイルを長押しして「レス内の画像をすべて保存」を選択する
- **THEN** レス本文から抽出した画像URLを一括で保存する

#### Scenario: 同一URLは1回だけ保存する
- **WHEN** レス本文に同一の画像URLが複数回含まれる
- **THEN** 当該URLの保存処理は1回だけ実行される

#### Scenario: 画像が1件のみの場合はメニューを表示しない
- **WHEN** 対象レス本文に画像URLが1件だけ含まれる
- **THEN** 「レス内の画像をすべて保存」は表示されない

### Requirement: 一括保存結果の件数通知
システムはレス内画像の一括保存完了後に、成功件数と失敗件数を通知するSHALL。

#### Scenario: 成功件数と失敗件数を表示する
- **WHEN** 一括保存が完了する
- **THEN** 成功件数と失敗件数をユーザーへ通知する

### Requirement: 画像メニューアクション実行の共通化
システムはスレッド画面の画像メニューで選択されたアクション実行を、画像ビューアと共通の実行処理で行うMUST。

#### Scenario: 同一アクションで同一の副作用を実行する
- **WHEN** ユーザーがスレッド画面の画像メニューからコピー、共有、外部アプリ起動、Web検索、保存のいずれかを選択する
- **THEN** システムは画像ビューアと同じ実行契約に従って対象画像に対する処理を開始する

#### Scenario: 画像URLが空の場合は処理しない
- **WHEN** 対象画像URLが空または無効な状態で画像メニューアクションが発火する
- **THEN** システムは副作用処理を実行せず、クラッシュせずに処理を終了する

